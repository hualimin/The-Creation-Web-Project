@using Models
@model OrderApply

@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>orderapply_detail</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/lib/layui-v2.5.5/css/layui.css" media="all">
    <link rel="stylesheet" href="/css/public.css" media="all">
</head>
<body>
    <div>
        <script src="/lib/layui-v2.5.5/layui.js" charset="utf-8"></script>
        <script src="~/Scripts/jquery-3.4.1.min.js"></script>
        <div class="layuimini-container">
            <div class="layuimini-main">


                @Html.Action("UserInfo", "Info", new { id = Model.UsersId })

                @Html.Action("CreatorInfo", "Info", new { id = ViewBag.CreatorID })

                @Html.Action("OrderInfo", "Info", new { id = Model.QOrderId })

                <fieldset class="layui-elem-field layui-field-title" style="margin-top: 50px;">
                    <legend>投诉订单内容</legend>
                </fieldset>

                <div class="layui-form-item">
                    <label class="layui-form-label">申诉描述：</label>
                    <div class="layui-tab-content">
                        <div class="layui-tab-item layui-show">@Model.ApplyDescrib</div>
                    </div>
                    <div class="layui-input-block">
                        <textarea placeholder="请输入内容" name="content" id="content" class="layui-textarea"></textarea>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">申诉日期：</label>
                    <div class="layui-tab-content">
                        <div class="layui-tab-item layui-show">@Model.ApplyDate</div>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">状态：</label>
                    <div class="layui-tab-content">
                        <div class="layui-tab-item layui-show">@Model.ApplyState</div>
                    </div>
                </div>

                @Html.Action("add_sys_msg", "Message")

                <div class="layui-form-item">
                    <button class="layui-btn" id="withExport">同意退单</button>  @*href="@Url.Action("deal_apply_p", "Apply", new { id = Model.ApplysId })"*@
                </div>

                <div class="layui-form-item">
                    <button class="layui-btn" id="bohui">驳回申请</button>  @*href="@Url.Action("deal_apply_p", "Apply", new { id = Model.ApplysId })"*@
                </div>


            </div>
        </div>
    </div>
    <script>
        $(document).on('click', "#withExport", function () {
            $.ajax({
                        url: "@Url.Action("orderapply_deal", "Order",new { id=Model.ApplyId,flag=1})",
                        async: true,
                        type: 'post',
                        success: function (data) {
                            if (data == 'success') {
                                layer.msg("处理成功!");
                                setTimeout(function () {
                                    //window.parent.location.href = 'list.do'; 或者
                                    parent.location.reload();//刷新父页面
                                }, 5 * 100);//延迟500毫秒
                            }
                            else {
                                layer.msg(data);
                            }
                        }
                    });
        });

        $(document).on('click', "#bohui", function () {
            $.ajax({
                        url: "@Url.Action("orderapply_deal", "Order",new { id=Model.ApplyId,flag=0})",
                        async: true,
                        type: 'post',
                        success: function (data) {
                            if (data == '已成功驳回申请！') {
                                layer.msg("已成功驳回申请！");
                                setTimeout(function () {
                                    //window.parent.location.href = 'list.do'; 或者
                                    parent.location.reload();//刷新父页面
                                }, 5 * 100);//延迟500毫秒
                            }
                            else {
                                layer.msg(data);
                            }
                        }
                    });
        });
    </script>
</body>
</html>
