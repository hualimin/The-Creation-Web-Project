@using Models
@model Users
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>修改密码</title>
    <link href="~/layui/css/layui.css" rel="stylesheet" />
</head>
<body>
    <div class="container">
        <form style="text-align: center;font-size:20px;">
            @Html.AntiForgeryToken()
            <span>创用户ID:</span><input type="text" id="userid" disabled="disabled" value="@Model.UsersId" /><br /><br />

            <span>旧密码:</span> <input type="text" id="pwd1" placeholder="请输入旧密码" /><br /><br />
            <span>新密码:</span><input type="password" name="password1" id="password1" placeholder="请输入新密码" /><br /><br />
            <span>确认密码:</span><input type="password" name="password2" id="password2" placeholder="请输入确认密码" /><br /><br />
            <div class="layui-table-btn2 ">
                <input type="submit" class="layui-btn" id="change_pwd" placeholder="确定">
                <a class="layui-btn layui-btn-primary cancel" onclick="window.history.back()">取 消</a>
            </div>
        </form>
    </div>
    <script src="~/Scripts/jquery-3.5.1.min.js"></script>
    <script>
        $("#change_pwd").click(function () {
            var pwd2 = $('#password1').val();
            var pwd3 = $('#password2').val();
            if ($('#pwd1').val().length == 0) {
                alert("请输入原密码");
            }
            else if ($('#pwd1').val() != @Model.UsersLogin.Pwd) {
                alert("原密码输入错误");
            }
            else if ($('#password1').val().length == 0) {
                alert("请输入新密码");
            }
            else if ($('#password2').val().length == 0) {
                alert("请确认密码");
            }
            else if (pwd2 != pwd3) {
                alert("两次密码不一致!");
            } else {
                $.ajax({
                    url: "/UserManage/AlterPwd",
                    type: "post",
                    data: {
                        password1: $('#password1').val()
                    },
                    success: function (data) {
                        if (data == "success") {
                            alert('修改成功！');
                        }
                        else {
                            alert(data);
                        }
                    }
                });
            }
        });
    </script>

</body>
</html>
